# 大文件使用指南

## 概述

本指南旨在说明GRM项目中被排除在Git版本控制之外的大文件的使用方法、存档位置，以及如何本地存档这些文件以支持完整还原，特别是为了支持分支2（使用预训练模型进行推理）和分支3（完整训练设置）。

## 被排除的大文件

根据 `.gitignore` 文件，以下目录和文件被排除在Git版本控制之外：

### 1. 模型文件
- **路径**: `model/pretrained_models/`
- **类型**: 预训练模型文件（如 `model_step_459-001.pt`）
- **用途**: 用于分支2（预训练模型推理）和分支3（完整训练设置）

### 2. 预训练权重
- **路径**: `pretrained_weights/`
- **类型**: 预训练模型权重文件
- **用途**: 用于分支2（预训练模型推理）和分支3（完整训练设置）

### 3. 其他大文件
- **路径**: `output/` 和 `downstream/`
- **类型**: 训练输出和下游任务结果
- **用途**: 用于分支3（完整训练设置）的结果存储

## 本地存档方法

### 1. 模型文件存档

#### 获取方式:
- 从项目提供的下载链接获取预训练模型
- 或从分支3的训练结果中保存模型文件

#### 存档位置:
```
model/pretrained_models/
```

#### 目录结构:
```
model/
└── pretrained_models/
    └── model_step_459-001.pt  # 预训练模型文件
```

### 2. 预训练权重存档

#### 获取方式:
- 从项目提供的下载链接获取预训练权重
- 或从分支3的训练结果中保存权重文件

#### 存档位置:
```
pretrained_weights/
```

#### 目录结构:
```
pretrained_weights/
└── [权重文件]  # 预训练模型权重文件
```

### 3. 训练输出存档

#### 获取方式:
- 从分支3的训练过程中生成

#### 存档位置:
```
output/
```

#### 目录结构:
```
output/
└── gram/
    └── pretrain_gram/  # 训练输出结果
```

## 完整还原步骤

### 步骤1: 克隆仓库并切换到目标分支

```bash
# 克隆仓库
git clone <仓库URL>
cd GRAM-main

# 切换到目标分支（例如分支2）
git checkout branch-pretrained-inference
```

### 步骤2: 还原大文件

1. **还原模型文件**:
   - 将存档的模型文件复制到 `model/pretrained_models/` 目录

2. **还原预训练权重**:
   - 将存档的预训练权重文件复制到 `pretrained_weights/` 目录

### 步骤3: 验证还原

```bash
# 检查文件是否存在
ls -la model/pretrained_models/
ls -la pretrained_weights/
```

## 分支支持说明

### 支持分支1: branch-sample-data-testing

- **所需文件**: 无特殊大文件需求（音频和视频文件已包含在Git中）
- **用途**: 用于测试示例数据的处理和模型的基本功能

### 支持分支2: branch-pretrained-inference

- **所需文件**:
  - `model/pretrained_models/` 目录中的预训练模型文件
  - `pretrained_weights/` 目录中的预训练权重文件
- **用途**: 验证预训练模型的推理功能，处理文本、视频和音频的多模态输入

### 支持分支3: branch-full-training-setup

- **所需文件**:
  - `model/pretrained_models/` 目录中的预训练模型文件（作为初始权重）
  - `pretrained_weights/` 目录中的预训练权重文件
  - 训练数据集（需单独下载，详见 TRAINING_SOLUTIONS.md）
- **用途**: 设置完整的训练环境，包括数据集下载和配置修改

## 注意事项

1. **存储空间**:
   - 预训练模型文件可能较大（数百MB），请确保有足够的存储空间
   - 完整的训练数据集可能非常大（数十GB），请确保有足够的存储空间

2. **网络带宽**:
   - 下载预训练模型和数据集需要稳定的网络连接和足够的带宽

3. **版本兼容性**:
   - 确保使用与代码兼容的模型版本
   - 训练数据集的格式和结构应与代码期望的一致

4. **备份**:
   - 建议定期备份预训练模型和重要的训练数据
   - 可以使用外部存储设备或云存储服务进行备份

## 故障排除

### 问题: 模型文件不存在

**解决方案**:
- 确保已将模型文件复制到正确的目录
- 检查模型文件的命名是否正确
- 确认模型文件的版本与代码兼容

### 问题: 预训练权重文件不存在

**解决方案**:
- 确保已将预训练权重文件复制到正确的目录
- 检查权重文件的命名是否正确
- 确认权重文件的版本与代码兼容

### 问题: 训练数据集缺失

**解决方案**:
- 参考 TRAINING_SOLUTIONS.md 中的说明下载完整的训练数据集
- 确保数据集的目录结构与配置文件中的路径一致

## 联系方式

如果在使用大文件过程中遇到问题，请参考项目的文档或联系项目维护者获取帮助。